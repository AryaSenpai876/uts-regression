---
title: "Analisis Korelasi Konsumsi Minyak Pemanas Rumah"
author: "Arya Senpai"
date: "`r Sys.Date()`"
output:
  html_document:
    theme: readable
    toc: true
    toc_float: true
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
library(ggplot2)
library(dplyr)
library(corrplot)
library(readr)
library(scales)
```

# Analisis Konsumsi Minyak Pemanas Rumah

## Korelasi & Visualisasi

### Matriks Korelasi

```{r}
data <- read_csv("HeatingOil.csv")

vars <- data %>%
  select(Heating_Oil, Insulation, Temperature, Num_Occupants, Avg_Age, Home_Size)

cor_matrix <- cor(vars)

cor_matrix

corrplot(
  cor_matrix, 
  method = "color",
  background.col = "black",
  bg = "red",              # Latar belakang gelap
  tl.col = "black",           # Warna label
  addCoef.col = "black",      # Warna angka korelasi
  number.cex = 0.7,
  tl.cex = 0.8
)
```

### Interpretasi Korelasi

- Temperature negatif dengan Heating_Oil
- Insulation negatif
- Home_Size positif

Faktor suhu, insulasi, dan ukuran rumah memengaruhi konsumsi energi.

### Visualisasi Heating_Oil vs Avg_Age

```{r}
ggplot(data, aes(x = Heating_Oil, y = Avg_Age, color = Heating_Oil)) +
  geom_point(size = 3, alpha = 0.9) +
  scale_color_gradient(low = "blue", high = "red") +
  labs(
    title = "Heating Oil vs Avg Age",
    x = "Heating Oil",
    y = "Average Age",
    color = "Heating Oil"
  ) +
  theme_minimal(base_family = "Arial")
```

### Visualisasi Temperature vs Insulation

```{r}
ggplot(data, aes(x = Temperature, y = Insulation, color = Heating_Oil)) +
  geom_point(size = 3, alpha = 0.9) +
  scale_color_gradient(low = "blue", high = "red") +
  labs(
    title = "Temperature vs Insulation",
    x = "Temperature (F)",
    y = "Insulation Score",
    color = "Heating Oil"
  ) +
  theme_minimal(base_family = "Arial")
```

### Rekomendasi

Target rumah:
- Suhu rendah
- Insulasi rendah
- Ukuran besar

## Model Prediktif

### Model Regresi

```{r}
model <- lm(Heating_Oil ~ Insulation + Temperature + Num_Occupants + Avg_Age + Home_Size, data = data)
summary(model)
```

### Simpan Model

```{r}
saveRDS(model, file = "model_heating_oil.rds")
```

### Aplikasi Model untuk Prediksi

```{r}
model_loaded <- readRDS("model_heating_oil.rds")
marketing_data <- read_csv("HeatingOil-Marketing.csv")
marketing_data$Predicted_Heating_Oil <- predict(model_loaded, newdata = marketing_data)
head(marketing_data)
```

### Penutup

Prediksi konsumsi minyak dapat dilakukan tanpa akses data asli. Proses ini aman dan efektif untuk tim pemasaran.
